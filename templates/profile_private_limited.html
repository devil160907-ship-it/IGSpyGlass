{% extends "base.html" %} {% block title %}Private Profile - {{ profile.username
}} | IGSpyGlass{% endblock %} {% block content %}
<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card border-warning shadow-sm">
        <div class="card-header bg-warning text-dark">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
              <i class="fas fa-lock"></i> Private Account - Limited Access
            </h4>
            {% if profile.is_verified %}
            <span class="badge bg-success">
              <i class="fas fa-check-circle"></i> Verified
            </span>
            {% endif %}
          </div>
        </div>
        <div class="card-body">
          <!-- Profile Header -->
          <div class="text-center py-4">
            <div class="mb-4">
              <img
                src="{{ profile.profile_pic_url }}"
                class="rounded-circle border border-3 border-warning"
                width="120"
                height="120"
                alt="{{ profile.username }}"
                onerror="this.src='https://api.dicebear.com/7.x/identicon/svg?seed={{ profile.username }}'"
              />
            </div>

            <h3 class="text-warning mb-2">@{{ profile.username }}</h3>
            {% if profile.full_name %}
            <p class="text-muted h5 mb-4">{{ profile.full_name }}</p>
            {% endif %} {% if profile.bio %}
            <div
              class="alert alert-light border text-start mx-auto"
              style="max-width: 500px"
            >
              <p class="mb-0">{{ profile.bio }}</p>
            </div>
            {% endif %}
          </div>

          <!-- Preview Content Section -->
          {% if profile.has_preview_content and profile.limited_posts %}
          <div class="preview-section mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="text-dark">
                <i class="fas fa-eye"></i> Preview Content
              </h5>
              <span class="badge bg-info">Limited Preview</span>
            </div>

            <div class="alert alert-info">
              <small>
                <i class="fas fa-info-circle"></i>
                The following content is publicly available preview from this
                private account
              </small>
            </div>

            <div class="row g-3">
              {% for post in profile.limited_posts %}
              <div class="col-md-4 col-sm-6">
                <div class="card h-100 border">
                  <div class="position-relative">
                    {% if post.type == 'video' %}
                    <video
                      class="card-img-top preview-media"
                      style="height: 200px; object-fit: cover"
                      preload="metadata"
                      onclick="openMediaModal('{{ post.preview_url }}', 'video')"
                    >
                      <source src="{{ post.preview_url }}" type="video/mp4" />
                      Your browser does not support the video tag.
                    </video>
                    <div class="position-absolute top-0 end-0 m-2">
                      <span class="badge bg-dark">
                        <i class="fas fa-play"></i> Video
                      </span>
                    </div>
                    {% else %}
                    <img
                      src="{{ post.preview_url }}"
                      class="card-img-top preview-media"
                      style="height: 200px; object-fit: cover"
                      alt="Preview content"
                      onclick="openMediaModal('{{ post.preview_url }}', 'image')"
                      onerror="this.style.display='none'"
                    />
                    <div class="position-absolute top-0 end-0 m-2">
                      <span class="badge bg-dark">
                        <i class="fas fa-image"></i> Image
                      </span>
                    </div>
                    {% endif %}
                  </div>
                  <div class="card-body">
                    <small class="text-muted">
                      <i class="fas fa-clock"></i>
                      {{ post.timestamp|format_time_ago if post.timestamp else
                      'Recent' }}
                    </small>
                    {% if post.caption %}
                    <p class="card-text small mt-2">
                      {{ post.caption[:100] }}{% if post.caption|length > 100
                      %}...{% endif %}
                    </p>
                    {% endif %}
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          <!-- Quick Actions -->
          <div class="quick-actions mb-4">
            <h5 class="text-dark mb-3">
              <i class="fas fa-bolt"></i> Quick Actions
            </h5>
            <div class="row g-2">
              <div class="col-md-3 col-6">
                <a
                  href="{{ url_for('preview_media', username=profile.username) }}"
                  class="btn btn-outline-primary w-100"
                >
                  <i class="fas fa-photo-video"></i> Media Preview
                </a>
              </div>
              <div class="col-md-3 col-6">
                <a
                  href="{{ url_for('preview_stories', username=profile.username) }}"
                  class="btn btn-outline-info w-100"
                >
                  <i class="fas fa-history"></i> Stories Preview
                </a>
              </div>
              <div class="col-md-3 col-6">
                <button
                  class="btn btn-warning download-btn w-100"
                  data-type="profile_pic"
                  data-url="{{ profile|tojson|urlencode }}"
                >
                  <i class="fas fa-download"></i> Save Profile Pic
                </button>
              </div>
              <div class="col-md-3 col-6">
                <a
                  href="https://www.instagram.com/{{ profile.username }}/"
                  target="_blank"
                  class="btn btn-success w-100"
                >
                  <i class="fab fa-instagram"></i> Open Instagram
                </a>
              </div>
            </div>
          </div>

          <!-- Information Cards -->
          <div class="row mt-4">
            <div class="col-md-6 mb-3">
              <div class="card border-success h-100">
                <div class="card-header bg-success text-white">
                  <h6 class="mb-0">
                    <i class="fas fa-check-circle"></i> Available Information
                  </h6>
                </div>
                <div class="card-body">
                  <div class="text-success small">
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Username:
                      <strong>@{{ profile.username }}</strong>
                    </div>
                    {% if profile.full_name %}
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Name:
                      <strong>{{ profile.full_name }}</strong>
                    </div>
                    {% endif %}
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Profile Picture
                    </div>
                    {% if profile.is_verified %}
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Verified Account
                    </div>
                    {% endif %} {% if profile.bio %}
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Bio Information
                    </div>
                    {% endif %} {% if profile.has_preview_content %}
                    <div class="mb-2">
                      <i class="fas fa-check"></i> Preview Content ({{
                      profile.limited_posts|length }} items)
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="card border-danger h-100">
                <div class="card-header bg-danger text-white">
                  <h6 class="mb-0">
                    <i class="fas fa-times-circle"></i> Restricted Information
                  </h6>
                </div>
                <div class="card-body">
                  <div class="text-danger small">
                    <div class="mb-2">
                      <i class="fas fa-times"></i> Full Posts & Stories
                    </div>
                    <div class="mb-2">
                      <i class="fas fa-times"></i> Follower Count
                    </div>
                    <div class="mb-2">
                      <i class="fas fa-times"></i> Following Count
                    </div>
                    <div class="mb-2">
                      <i class="fas fa-times"></i> Post Analytics
                    </div>
                    <div class="mb-2">
                      <i class="fas fa-times"></i> Detailed Profile Information
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Private Account Notice -->
          <div class="alert alert-warning mt-4">
            <h6 class="alert-heading">
              <i class="fas fa-shield-alt"></i> Private Account Information
            </h6>
            <p class="mb-2">
              This Instagram account is set to private by its owner. We respect
              privacy settings and can only display information that is publicly
              accessible.
            </p>
            <hr />
            <p class="mb-0 small">
              <strong>To view full content:</strong> Send a follow request from
              the Instagram app and wait for approval from the account owner.
            </p>
          </div>

          <!-- Action Buttons -->
          <div class="text-center mt-4">
            <div class="btn-group" role="group">
              <a href="{{ url_for('index') }}" class="btn btn-primary">
                <i class="fas fa-search"></i> Search Another Profile
              </a>
              <a
                href="{{ url_for('preview_media', username=profile.username) }}"
                class="btn btn-outline-primary"
              >
                <i class="fas fa-expand"></i> Full Media Preview
              </a>
              <button
                class="btn btn-outline-warning"
                onclick="window.history.back()"
              >
                <i class="fas fa-arrow-left"></i> Go Back
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Media Modal -->
<div class="modal fade" id="mediaModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Preview Content</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body text-center">
        <img id="modalImage" src="" class="img-fluid" style="display: none" />
        <video id="modalVideo" controls class="img-fluid" style="display: none">
          Your browser does not support the video tag.
        </video>
      </div>
    </div>
  </div>
</div>

<style>
  .preview-media {
    cursor: pointer;
    transition: transform 0.2s;
  }
  .preview-media:hover {
    transform: scale(1.02);
  }
  .card {
    transition: box-shadow 0.2s;
  }
  .card:hover {
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }
</style>

<script>
  function openMediaModal(url, type) {
    const modalImage = document.getElementById("modalImage");
    const modalVideo = document.getElementById("modalVideo");

    if (type === "image") {
      modalImage.src = url;
      modalImage.style.display = "block";
      modalVideo.style.display = "none";
    } else if (type === "video") {
      modalVideo.innerHTML = `<source src="${url}" type="video/mp4">`;
      modalVideo.style.display = "block";
      modalImage.style.display = "none";
    }

    const modal = new bootstrap.Modal(document.getElementById("mediaModal"));
    modal.show();
  }

  // Initialize tooltips
  document.addEventListener("DOMContentLoaded", function () {
    const tooltipTriggerList = [].slice.call(
      document.querySelectorAll('[data-bs-toggle="tooltip"]')
    );
    const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  });
</script>
{% endblock %}
